{% extends "/main/layout.html" %}

{% block additional_head %}

<link rel="stylesheet" href="{{url_for('static', filename='css/main/dashboard.css')}}">
{% endblock %}

{% block content %}

<div class="dashboard-header">
  <h1>Welcome back, <span style="color: var(--primary-blue);">{{user_name}}!</h1>
  <p>Manage and track all your projects in one place</p>
</div>

<div class="container" style="max-width: 1200px;">
    <div class="quick-actions">
        <a href="{{url_for('create_project')}}" class="action-card">
            <div class="action-card-icon">
                <i class="bi bi-plus-lg"></i>
            </div>
            <h3>Create New Project</h3>
            <p>Start organizing your work with a new project board</p>
        </a>

        <a href="{{url_for('tasks')}}" class="action-card">
            <div class="action-card-icon">
                <i class="bi bi-clipboard-check"></i>
            </div>
            <h3>My Tasks</h3>
            <p>View all tasks assigned to you across projects</p>
        </a>

        <a href="{{url_for('projects')}}" class="action-card">
            <div class="action-card-icon">
                <i class="bi bi-folder2-open"></i>
            </div>
            <h3>Browse Projects</h3>
            <p>See all your projects and team boards</p>
        </a>
    </div>

    <div class="section-header">
        <div class="section-title">
            <i class="bi bi-star-fill"></i>
            <span>Starred Projects</span>
        </div>
        <a href="{{url_for('projects')}}" class="view-all-link">
            View all projects
            <i class="bi bi-arrow-right"></i>
        </a>
    </div>

    <div class="projects-grid" id="starredProjects">
        {% if projects %}
            {% for project in projects %}
                <a href="{{url_for('view_project', project_id=project._id)}}" class="project-card">
                    <div class="project-card-header {{project.color}}">
                        <button class="star-button starred" onclick="event.preventDefault(); toggleStar(this);">
                            <i class="bi bi-star-fill"></i>
                        </button>
                    </div>
                    <div class="project-card-body">
                        <h3 class="project-card-title">{{project.project_name}}</h3>
                        <div class="project-card-meta">
                            <span><i class="bi bi-people-fill"></i>{{ project.member_count or 1 }} member{{ 's' if (project.member_count or 1) != 1 else '' }}</span>
                            <span><i class="bi bi-clipboard"></i>{{ project.total_tasks or 0 }} task{{ 's' if (project.total_tasks or 0) != 1 else '' }}</span>
                        </div>
                    </div>
                </a>
            {%endfor%}
        {% else %}
            <div class="empty-state">
                <div class="empty-state-content text-center">
                    <i class="bi bi-folder2-open"></i>
                    <h3>No Projects Yet</h3>
                    <p>Create your first project to start organizing your work</p>
                </div>
            </div>
        {% endif %}
    </div>

    <div class="section-header">
        <div class="section-title">
            <i class="bi bi-clock-history"></i>
            <span>Recently Viewed</span>
        </div>
    </div>

    <div class="projects-grid" id="recentProjects">
        {% if projects %}
            {% set has_recent = namespace(value=false) %}
            {% for project in projects %}
                {% if project.last_viewed %}
                    {% set has_recent.value = true %}
                    <a href="{{url_for('view_project', project_id=project._id)}}" class="project-card">
                        <div class="project-card-header {{project.color}}">
                            <button class="star-button starred" onclick="event.preventDefault(); toggleStar(this);">
                                <i class="bi bi-star-fill"></i>
                            </button>
                        </div>
                        <div class="project-card-body">
                            <h3 class="project-card-title">{{project.project_name}}</h3>
                            <div class="project-card-meta">
                                <span><i class="bi bi-people-fill"></i>{{ project.member_count or 1 }} member{{ 's' if (project.member_count or 1) != 1 else '' }}</span>
                                <span><i class="bi bi-clipboard"></i>{{ project.total_tasks or 0 }} task{{ 's' if (project.total_tasks or 0) != 1 else '' }}</span>
                            </div>
                        </div>
                    </a>
                {% endif %}
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <div class="empty-state-content text-center">
                    <i class="bi bi-clock-history"></i>
                    <h3>No Recently Viewed Projects</h3>
                    <p>Projects you view will appear here</p>
                </div>
        {% endif %}
    </div>
</div>

{% endblock %}