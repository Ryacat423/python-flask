{% extends "/main/layout.html" %}

{% block additional_head %}
<link rel="stylesheet" href="{{url_for('static', filename='css/others/profile.css')}}">
{% endblock %}

{% block content %}

<div >
  <div class="profile-header">
    <div class="profile-top">
      <div class="avatar-section">
        <div class="avatar">
          {% if profile %}
            <img src="{{ profile }}" alt="User Profile">
          {%endif%}
        </div>
        <form action="{{url_for('profile')}}" enctype="multipart/form-data" method="POST">
          <div class="avatar-upload text-dark" title="Change avatar">
            <label for="profile-input" style="cursor: pointer;">
              <i class="bi bi-camera"></i>
            </label>
            <input type="file" id="profile-input" accept="image/*" name="profile" style="display: none;" onchange="this.form.submit()">
          </div>
        </form>

      </div>
      <div class="profile-info">
        <h1>{{user_name}}</h1>
        <p>@{{user_name|lower|replace(' ', '')}}</p>
      </div>
    </div>
  </div>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div>
        {% for category, message in messages %}
        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
  {% endwith %}

  <div class="profile-content">
    <div class="profile-section">
      <h2 class="section-title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        Personal Information
      </h2>
      <form action="{{ url_for('profile') }}" method="POST">
        <input type="hidden" name="action" value="update_info">
        <!-- <div class="form-group">
          <label for="fullname">Full Name</label>
          <input type="text" id="fullname" value="{{user_name}}" placeholder="Enter your full name">
        </div> -->
        <div class="form-group">
          <label for="firstname">First Name</label>
          <input type="text" id="firstname" name="firstname" 
            value="{{ firstname }}" placeholder="Enter your first name">
        </div>

        <div class="form-group">
          <label for="lastname">Last Name</label>
          <input type="text" id="lastname" name="lastname" 
            value="{{ lastname }}" placeholder="Enter your last name">
        </div>
        <div class="form-group">
          <label for="email">Email Address</label>
          <input type="email" id="email" value="{{user_email}}" placeholder="your.email@example.com" name="email">
        </div>
        <!-- <div class="form-group">
          <label for="bio">Bio</label>
          <textarea id="bio" placeholder="Tell us about yourself...">Project manager passionate about productivity and team collaboration.</textarea>
        </div> -->
        <div class="button-group">
          <button type="submit" class="btn btn-primary">Save Changes</button>
          <button type="button" class="btn btn-secondary">Cancel</button>
        </div>
      </form>
    </div>

    <div class="profile-section">
      <h2 class="section-title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        </svg>
        Security
      </h2>

      <form action="{{url_for('profile')}}" method="POST">
        <input type="hidden" name="action" value="update_password">
        <div class="form-group">
          <label for="current-password">Current Password</label>
          <input type="password" id="current-password" placeholder="Enter current password" name="current_password">
        </div>
        <div class="form-group">
          <label for="new-password">New Password</label>
          <input type="password" id="new-password" placeholder="Enter new password" name="new_password">
        </div>
        <div class="form-group">
          <label for="confirm-password">Confirm New Password</label>
          <input type="password" id="confirm-password" placeholder="Confirm new password" name="confirm_password">
        </div>
        <div class="button-group">
          <button type="submit" class="btn btn-primary">Update Password</button>
        </div>
      </form>
    </div>
  </div>
</div>

{% endblock %}